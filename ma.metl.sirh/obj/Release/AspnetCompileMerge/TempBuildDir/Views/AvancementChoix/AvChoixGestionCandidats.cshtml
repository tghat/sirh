@model Tuple<IEnumerable<ma.metl.sirh.Model.Dto.CandidatResultatDto>, ma.metl.sirh.Model.Dto.CandidatCritereRechDto, ma.metl.sirh.Model.Dto.CandidatResultatDto, ma.metl.sirh.Model.Dto.CandidatDto>
@using ma.metl.sirh.Model

<script type="text/javascript">

    function DeleteAskToConfirm(detailAvancementId) {
        $('#paramValue').html(detailAvancementId);
        $('#deleteCandidat').modal();
    }

    function addCandidatModal(candidatId) {
        $('#newCandidat').modal();
    }

    function getDecisionPopup() {
        $('#decisonCAP').modal();
        $('#motifDecisonId').hide();
    }

    function deleteCandidat() {
        var id = document.getElementById('paramValue').innerHTML;
        $.post('@Url.Action("SupprimerCandidat")/?id=' + id, {}, function (data) {
            if (data.IsDeleted) {
                // Refresh the page
                window.location.reload();
            }
        });
    }

    function OnMoyenneChange() {
        $('#UpdateMoyenne').modal();
    }

    function UpdateMoyenneCandidat() {
        var moyenneValue = $('#moyenneValueId').val();
        //AJAX
        $.ajax({
            type: "POST",
            url: 'UpdateMoyenneCandidat',
            data: { moyenneValue: moyenneValue, avancementDetailId: @ViewBag.detailAvancementId +""},
            datatype: 'json',
            success: function (data) {
                var moyenne = data.data;
                $('#moyenneValueId').val(moyenne);
                $('#UpdateMoyenne').modal('hide');
                $('#msgInfoId').html(data.messageInfo);
                $('#msgErrorId').html(data.messageError);
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert(textStatus)
            }
        });
    }

    function ToJavaScriptDate(value) {
        if (value != null) {
            var pattern = /Date\(([^)]+)\)/;
            var results = pattern.exec(value);
            var dt = new Date(parseFloat(results[1]));
            return dt.getDate() + "/" + (dt.getMonth() + 1) + "/" + dt.getFullYear();
        }
        return null;
    }

    function OnNewCandidatChange() {

        var numDotiId = $('#new-CandidatNumDoti').val();

        //AJAX
        $.ajax({
            type: "POST",
            url: 'GetCandidatGipeOrdByNumDoti',
            data: { numDoti: numDotiId },
            datatype: 'json',
            success: function (data) {
                var candidat = data.data;
                $('#new-CandidatCinId').val(candidat.CIN);
                $('#new-CandidatNomId').val(candidat.Nom);
                $('#new-CandidatPrenomId').val(candidat.Prenom);
                $('#new-CandidatDateNaissanceId').val(ToJavaScriptDate(candidat.DateNaissance));
                $('#new-CandidatDateRecrutementId').val(ToJavaScriptDate(candidat.DateRecrutement));
                $('#new-AncienGradeId').val(candidat.AncienGrade);

                if (candidat.Sexe == "M") {
                    document.getElementById("hommeId").checked = "checked";
                }
                if (candidat.Sexe == "F") {
                    document.getElementById("femmeId").checked = "checked";
                }

                $('#msgInfoId').html(data.message);
                $('#newCandidatAddId').prop('disabled', data.flag);
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert(textStatus)
            }
        });
    }

    function EditCandidat(candidatId, detailAvancementId) {
        $('#editCandidatId').modal();

        //AJAX
        $.ajax({
            type: "POST",
            url: 'editerCandidat',
            data: { candidatId: candidatId, detailAvancementId: detailAvancementId },
            datatype: 'json',
            success: function (data) {

                var candidat = data.data;

                $('#candidatEditId').val(candidatId);
                $('#detailAvancementEditId').val(detailAvancementId);
                $('#edit-CandidatNumDoti').val(candidat.NumDoti);
                $('#edit-CandidatCinId').val(candidat.CIN);
                $('#edit-CandidatNomId').val(candidat.Nom);
                $('#edit-CandidatPrenomId').val(candidat.Prenom);
                $('#edit-CandidatDateNaissanceId').val(ToJavaScriptDate(candidat.DateNaissance));
                $('#edit-CandidatDateRecrutementId').val(ToJavaScriptDate(candidat.DateRecrutement));

                if (candidat.Sexe == "M") {
                    document.getElementById("edit-hommeId").checked = "checked";
                }
                if (candidat.Sexe == "F") {
                    document.getElementById("edit-femmeId").checked = "checked";
                }

                $('#edit-CandidatAncienGradeId').val(candidat.ancienGradeId);
                $('#edit-CandidatNouveauGradeId').val(candidat.nouveauGradeId);

            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert(textStatus)
            }
        });
    }

    function GetSynthese(id, noteMoyenne, detailAvancement) {
        $('#candidatId').val(id);
        $('#moyenne').val(noteMoyenne);
        $('#detail').val(detailAvancement);
        $('#hiddenSynteseId').val("syntese");
        document.forms['form-recherche'].submit();
    }

    function GenererRapport(id, detailsId) {
        window.location = '@Url.Action("GenererCandidatDetails", "AvancementChoix")' + '?candidatId=' + id + "&detailsId=" + detailsId;
    }
</script>

<div class="row col-md-12">  
        <h1 class="page-header">Gestion des candidats</h1>  
</div>

<label style="color:red">@ViewBag.ErrorMessage</label>
<label style="color:green">@ViewBag.successMessage</label>

@{var roles = Session["listRoles"] as List<string>;}
<div class="row">

    <!--*********************************Critères de Recherche************************************************-->
    <fieldset class="col-md-12">
        <legend>Critères de Recherche</legend>
        <form name="form-recherche" id="form-recherche" action="" method="post" class="form-horizontal">
            <div class="form-group">
                @Html.Hidden("candidatId")
                @Html.Hidden("moyenne")
                @Html.Hidden("detail")
             
                <div class="col-md-3" style="display:none">
                    <label id="paramValue"></label>
                </div>
                <div class="col-md-3">
                    <label for="annee">Année de promotion:</label>
                </div>
                <div class="col-md-3">
                    @Html.DropDownListFor(x => x.Item2.AnneeProm, ViewBag.Annee as SelectList, "---- Sélectionnez ----", new { @class = "form-control" })
                </div>
                <div class="col-md-3">
                    <label for="annee">Grade:</label>
                </div>
                <div class="col-md-3">
                    @Html.DropDownListFor(x => x.Item2.GradeId, ViewBag.Grades as SelectList, "---- Sélectionnez ----", new { @class = "form-control" })
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-3">
                    <label for="anciennteGrade"> Ancienneté de grade:</label>
                </div>
                <div class="col-md-3">
                    @Html.TextBoxFor(x => x.Item2.AncienneteGrade, new { Value = "", @class = "form-control" })
                </div>
                <div class="col-md-3">
                    <label for="anciennteEchelon"> Ancienneté d'échelon:</label>
                </div>
                <div class="col-md-3">
                    @Html.TextBoxFor(x => x.Item2.AncienneteEchelon, new { Value = "", @class = "form-control" })
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-3">
                    <label for="dateRecrutement">Date de Recrutement:</label>
                </div>
                <div class="col-md-3">
                    @Html.TextBoxFor(x => x.Item2.DateRecrutement, DateTime.Now.ToString("d"), new { @class = "form-control datepicker" })
                </div>
                <div class="col-md-3">
                    <label for="numDOTI">N° DOTI:</label>
                </div>
                <div class="col-md-3">
                    @Html.TextBoxFor(x => x.Item2.NumDoti, null, new { @class = "form-control" })
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-3">
                    <label for="dateNaissance">Date de Naissance:</label>
                </div>
                <div class="col-md-3">
                    @Html.TextBoxFor(x => x.Item2.DateNaissance, DateTime.Now.ToString("d"), new { @class = "form-control datepicker" })
                </div>
                <div class="col-md-3">
                    <label for="Commission">Localité:</label>
                </div>
                <div class="col-md-3">
                    @Html.DropDownListFor(x => x.Item2.RegionId, ViewBag.Regions as SelectList, "---- Sélectionnez ----", new { @class = "form-control" })
                </div>
            </div>
            <div class="b-right">
               @if (roles.Contains("AvChoix_Candidat_Creation"))
                {
                <a class="btn btn-custom" href="javascript:addCandidatModal()">
                    <i class="fa fa-plus btn"></i>
                    Nouveau candidat
                </a>
                }
                <a class="btn btn-custom ">
                    <i class="fa fa-search"></i>
                    <input type="submit" value="Rechercher" class="btn btn-custom btn-xs" />
                </a>
             </div>
            <input id="hiddenSynteseId" type="text" name="name" hidden />
        </form>
    </fieldset>

    <!--*********************************************Résultats de Recherche************************************************-->
    <fieldset class="col-md-12">
        <legend>R&eacute;sultats de Recherche</legend>
        <form action="changerStatut" method="post" class="form-horizontal" id="formSelected">
            <div class="table-responsive">

                <table class="table table-bordered table-striped  table-hover" id="myTable">
                    <thead>
                        <tr>
                            <th><input name="case" type="checkbox" id="chkSelectAll" /></th>
                            <th><div align="center">N°DOTI </div></th>
                            <th><div align="center">Nom</div></th>
                            <th><div align="center">Pr&eacute;nom</div></th>
                            <th><div align="center">Ancien grade</div></th>
                            <th><div align="center">Nouveau grade</div></th>
                            <th><div align="center">Date d'effet</div></th>
                            <th><div align="center">Direction</div></th>
                            <th><div align="center">Localit&eacute;</div></th>
                            <th><div align="center">Statut</div></th>
                            <th><div align="center">D&eacute;cision CAP</div></th>
                            <th><div align="center">Actions</div></th>
                        </tr>
                    </thead>
                    <tbody>
                        @Html.EditorFor(m => m.Item1)
                    <tbody>
                </table>
                @if (Model.Item1.Count() != 0)
                {
                    <div class="b-right" style="margin-top: 10px;">
                        @if (roles.Contains("AvChoix_Candidat_Verification"))
                        {
                            <a class="btn btn-custom btn-xs">
                                <i class="fa fa-check"></i>
                                <input type="submit" value="Vérifier" class="btn btn-custom btn-xs" name="verificationAction" />
                            </a>
                        }
                        @if (roles.Contains("AvChoix_Candidat_Validation"))
                        {
                            <a class="btn btn-success btn-xs">
                                <i class="fa fa-check"></i>
                                <input type="submit" value="Valider" class="btn btn-success btn-xs" name="validationAction" />
                            </a>
                        }
                        @if (roles.Contains("AvChoix_Candidat_Decision"))
                        {
                            <a class="btn btn-custom" href="javascript:getDecisionPopup();">
                                <i class="fa fa-legal"></i>
                                Décision CAP
                            </a>
                        }
                    </div>
                }
            </div>

            <!-- ************* decisonCAP ******************** -->
            <div id="decisonCAP" class="modal fade">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title">Décison CAP</h4>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <div class="col-md-3">
                                    <label>Candidat Promu :</label>
                                </div>
                                <div class="col-md-3">
                                    <label class="radio-inline">
                                        @Html.RadioButtonFor(x => x.Item4.decision, "F", new { id = "promuId" })
                                        Oui
                                       
                                    </label>
                                </div>
                                <div class="col-md-3">
                                    <label class="radio-inline">
                                        @Html.RadioButtonFor(x => x.Item4.decision, "DF", new { id = "nonPromuId" })
                                        Non
                                    </label>
                                </div>
                            </div>
                            @Html.ValidationMessageFor(x => x.Item4.decision, null, new { style = "color: red" })
                            <div class="form-group" id="motifDecisonId">
                                <div class="col-md-3">
                                    <label>Motif de report :</label>
                                </div>

                                <div class="col-md-12" id="motifRejetId">
                                    @Html.TextAreaFor(x => x.Item4.motifDecision, 3, 50, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(x => x.Item4.motifDecision, null, new { style = "color: red" })
                                </div>
                            </div>
                            <div class="modal-footer">
                                <input type="submit" value="Enregistrer" class="btn btn-custom btn-lg" name="decisionAction" />
                                <button type="button" class="btn btn-custom" data-dismiss="modal">Fermer</button>
                            </div>
                        </div>
                    </div><!-- /.modal-content -->
                </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
        </form>
    </fieldset>

    <!--********************************************************Synthése*************************************************-->
    @if (ViewBag.rendredSyntese)
    {
    <fieldset class="col-md-12">
        <legend>Synth&egrave;se</legend>

        <div class="row">
            <div class="col-md-5">
                <label id="msgInfoId" style="color:green"></label>
                <label id="msgErrorId" style="color:red"></label>
            </div>
        </div>

        <!-- Nav tabs -->
        <ul class="nav nav-tabs">
            <li class="active"><a href="#situationCandidat" data-toggle="tab">Situation candidat</a></li>
            <li><a href="#sanctions" data-toggle="tab">Sanctions</a></li>
            <li><a href="#notation" data-toggle="tab">Notation</a></li>
            <li><a href="#historique" data-toggle="tab">Historique</a></li>
        </ul>

        <!--***********************************Situation candidat***************************************************-->
        <div class="tab-content">
            <div class="tab-pane fade in active" id="situationCandidat">
                <form name="form-situationCandidat" id="form-situationCandidat" action="" method="post" class="form-horizontal">

                    <div class="form-group">
                        <div class="col-md-3">
                            <label>N° DOTI </label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item3.NumDoti, new { @class = "form-control", disabled = "disabled" })
                        </div>
                        <div class="col-md-3">
                            <label>CIN </label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item3.CIN, new { @class = "form-control", disabled = "disabled" })
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label>Nom  </label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item3.Nom, new { @class = "form-control", disabled = "disabled" })
                        </div>
                        <div class="col-md-3">
                            <label>Prénom  </label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item3.Prenom, new { @class = "form-control", disabled = "disabled" })
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label>Sexe:</label>
                        </div>
                        <div class="col-md-3">
                            <label class="radio-inline">
                                    @Html.RadioButtonFor(x => x.Item3.Sexe, "M", new { id = "synthese-hommeId", disabled = "disabled" })
                                Homme
                            </label>
                        </div>
                        <div class="col-md-3">
                            <label class="radio-inline">
                                @Html.RadioButtonFor(x => x.Item3.Sexe, "F", new { id = "synthese-femmeId", disabled = "disabled" })
                                Femme
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label for="dateNaissance">Date de Naissance:</label>
                        </div>
                        <div class="col-md-3">
                                @Html.TextBoxFor(x => x.Item3.DateNaissance, "{0:MM/dd/yyyy}", new { @class = "form-control", disabled = "disabled" })
                        </div>
                        <div class="col-md-3">
                            <label for="dateRecrutement">Date de Recrutement:</label>
                        </div>
                        <div class="col-md-3">
                                @Html.TextBoxFor(x => x.Item3.DateRecrutement, "{0:MM/dd/yyyy}", new { @class = "form-control", disabled = "disabled" })
                        </div>
                    </div>
                </form>
            </div>

            <!--***********************************sanctions*****************************************************************-->
            <div class="tab-pane fade" id="sanctions">
                <form name="form-situationCandidat" id="form-situationCandidat" action="" method="post" class="form-horizontal">
                    <div class="table-responsive">
                        <table class="table table-bordered table-striped  table-hover" id="myTable">
                            <thead>
                                <tr>
                                    <th><div align="center">Sanction</div></th>
                                    <th><div align="center">Date d'effet</div></th>
                                    <th><div align="center">Référence </div></th>
                                    <th><div align="center">Année acte </div></th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.Item3.Sanctions)
                                    {
                                    <tr>
                                        <td>@Html.DisplayFor(modelItem => item.Description)</td>
                                        <td>@Html.DisplayFor(modelItem => item.DateEffet)</td>
                                        <td>@Html.DisplayFor(modelItem => item.Reference)</td>
                                        <td>@Html.DisplayFor(modelItem => item.AnneeActe)</td>
                                    </tr>
                                    }
                            <tbody>
                        </table>
                    </div>
                </form>
            </div>

            <!--***********************************************Notation***************************************************-->
            <div class="tab-pane fade" id="notation">
                <form name="form-situationCandidat" id="form-situationCandidat" action="" method="post" class="form-horizontal">
                    <div class="form-group">
                        <div class="col-md-3">
                            <label>Note moyenne </label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item3.NoteMoyenne, new { Value = ViewBag.noteMoyenne, id = "moyenneValueId", @class = "form-control", onchange = "OnMoyenneChange()" })
                        </div>
                    </div>
                </form>
            </div>

            <!--***********************************************Notation***************************************************-->
            <div class="tab-pane fade" id="historique">
                <form name="form-situationCandidat" id="form-situationCandidat" action="" method="post" class="form-horizontal">
                    <div class="table-responsive">
                        <table class="table table-bordered table-striped  table-hover" id="myTable">
                            <thead>
                                <tr>
                                    <th><div align="center">Action</div></th>
                                    <th><div align="center">Message</div></th>
                                    <th><div align="center">Utilisateur</div></th>
                                    <th><div align="center">Date action</div></th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.Item3.Historiques)
                                    {
                                    <tr>
                                        <td>@Html.DisplayFor(modelItem => item.Action)</td>
                                        <td>@Html.DisplayFor(modelItem => item.Message)</td>
                                        <td>@Html.DisplayFor(modelItem => item.User.Name) &nbsp; @Html.DisplayFor(modelItem => item.User.Prenom)</td>
                                        <td>@Html.DisplayFor(modelItem => item.DateAction)</td>
                                    </tr>
                                    }
                            <tbody>
                        </table>
                    </div>
                </form>
            </div>
        </div>
    </fieldset>
}
</div>

<!-- ************* DeleteCandidat ************************ -->
<div id="deleteCandidat" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Suppression d&#146;un candidat</h4>
            </div>
            <form name="form-supprimerCandidat" id="form-supprimerCandidat" action="supprimerCandidat" method="post" class="form-horizontal">
                <div class="modal-body">
                    <p>Êtes-vous sûr de vouloir supprimer ?</p>
                </div>
                <div class="modal-footer">
                    <a class="btn btn-custom btn-xs" href="javascript:deleteCandidat()" title="Supprimer">
                        <i class="fa fa-trash-o"></i>
                        Oui
                    </a>
                    <button type="button" class="btn btn-custom btn-xs" data-dismiss="modal">Non</button>
                </div>
            </form>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<!-- ************* UpdateMoyenneCandidat ************************ -->
<div id="UpdateMoyenne" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Modification note moyenne</h4>
            </div>
            <form name="form-modifierMoyenneCandidat" id="form-modifierMoyenneCandidat" action="" method="post" class="form-horizontal">
                <div class="modal-body">
                    <p>Etes vous sûr de vouloir modifier la note ?</p>
                </div>
                <div class="modal-footer">
                    <a class="btn btn-custom btn-xs" href="javascript:UpdateMoyenneCandidat()" title="Modifier">
                        <i>Oui</i>
                    </a>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Non</button>
                </div>
            </form>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<!-- ************* newCandidat ***************************** -->
<div id="newCandidat" class="modal fade">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Nouveau candidat</h4>
            </div>
            <div class="modal-body">
                <form name="form-newCandidat" id="form-newCandidat" action="creerCandidat" method="post" class="form-horizontal">
                    <div class="row">
                        <div class="col-md-5">
                            <label id="msgInfoId" style="color:red"></label>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label>N°Dotti:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item4.NumDoti, null, new { @class = "form-control", id = "new-CandidatNumDoti", onchange = "OnNewCandidatChange()" })
                            @Html.ValidationMessageFor(x => x.Item4.NumDoti, null, new { style = "color: red" })
                        </div>
                        <div class="col-md-3">
                            <label>CIN:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item4.CIN, null, new { @class = "form-control", disabled = "disabled", id = "new-CandidatCinId" })
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label>Nom:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item4.Nom, null, new { @class = "form-control", disabled = "disabled", id = "new-CandidatNomId" })
                        </div>
                        <div class="col-md-3">
                            <label>Prénom:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item4.Prenom, null, new { @class = "form-control", disabled = "disabled", id = "new-CandidatPrenomId" })
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label>Sexe:</label>
                        </div>
                        <div class="col-md-3">
                            <label class="radio-inline">
                                @Html.RadioButtonFor(x => x.Item4.Sexe, "Homme", new { disabled = "disabled", id = "hommeId" })
                                Homme
                            </label>
                        </div>
                        <div class="col-md-3">
                            <label class="radio-inline">
                                @Html.RadioButtonFor(x => x.Item4.Sexe, "Femme", new { disabled = "disabled", id = "femmeId" })
                                Femme
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label for="dateNaissance">Date de Naissance:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item4.DateNaissance, DateTime.Now.ToString("d"), new { @class = "form-control datepicker", disabled = "disabled", id = "new-CandidatDateNaissanceId" })
                        </div>
                        <div class="col-md-3">
                            <label for="dateRecrutement">Date de Recrutement:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item4.DateRecrutement, null, new { @class = "form-control datepicker", disabled = "disabled", id = "new-CandidatDateRecrutementId" })
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label for="dateNaissance">Ancien grade:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item4.AncienGrade, null, new { @class = "form-control", disabled = "disabled", id = "new-AncienGradeId" })
                        </div>
                        <div class="col-md-3">
                            <label for="dateRecrutement">Nouveau grade:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.DropDownListFor(x => x.Item4.GradeId, ViewBag.Grades as SelectList, "---- Sélectionnez ----", new { @class = "form-control" })
                            @Html.ValidationMessageFor(x => x.Item4.GradeId, null, new { style = "color: red" })
                        </div>
                    </div>
                    <div class="modal-footer">
                        <input type="submit" value="Enregistrer" class="btn btn-custom btn-lg" id="newCandidatAddId" />
                        <button type="button" class="btn btn-custom" data-dismiss="modal">Fermer</button>
                    </div>
                </form>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<!-- ************* editCandidat ***************************** -->
<div id="editCandidatId" class="modal fade">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Actualiser candidat</h4>
            </div>
            <div class="modal-body">
                <form name="form-editCandidat" id="form-editCandidat" action="modifierCandidat" method="post" class="form-horizontal">
                    @Html.HiddenFor(x => x.Item4.NumDoti, new { id = "candidatEditId" })
                    @Html.HiddenFor(x => x.Item4.detailAvancementId, new { id = "detailAvancementEditId" })
                    <div class="row">
                        <div class="col-md-5">
                            <label id="msgInfoId" style="color:red"></label>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label>N°Dotti:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item4.NumDoti, null, new { @class = "form-control", id = "edit-CandidatNumDoti", disabled = "disabled" })
                        </div>
                        <div class="col-md-3">
                            <label>CIN:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item4.CIN, null, new { @class = "form-control", id = "edit-CandidatCinId", disabled = "disabled" })
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label>Nom:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item4.Nom, null, new { @class = "form-control", id = "edit-CandidatNomId", disabled = "disabled" })
                            @Html.ValidationMessageFor(x => x.Item4.Nom, null, new { style = "color: red" })
                        </div>
                        <div class="col-md-3">
                            <label>Prénom:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item4.Prenom, null, new { @class = "form-control", id = "edit-CandidatPrenomId", disabled = "disabled" })
                            @Html.ValidationMessageFor(x => x.Item4.Prenom, null, new { style = "color: red" })
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label>Sexe:</label>
                        </div>
                        <div class="col-md-3">
                            <label class="radio-inline">
                                @Html.RadioButtonFor(x => x.Item4.Sexe, "M", new { id = "edit-hommeId", disabled = "disabled" })
                                Homme
                            </label>
                        </div>
                        <div class="col-md-3">
                            <label class="radio-inline">
                                @Html.RadioButtonFor(x => x.Item4.Sexe, "F", new { id = "edit-femmeId", disabled = "disabled" })
                                Femme
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label for="dateNaissance">Date de Naissance:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item4.DateNaissance, DateTime.Now.ToString("d"), new { @class = "form-control datepicker", id = "edit-CandidatDateNaissanceId", disabled = "disabled" })
                            @Html.ValidationMessageFor(x => x.Item4.DateNaissance, null, new { style = "color: red" })
                        </div>
                        <div class="col-md-3">
                            <label for="dateRecrutement">Date de Recrutement:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.TextBoxFor(x => x.Item4.DateRecrutement, null, new { @class = "form-control datepicker", id = "edit-CandidatDateRecrutementId", disabled = "disabled" })
                            @Html.ValidationMessageFor(x => x.Item4.DateRecrutement, null, new { style = "color: red" })
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label for="dateNaissance">Ancien grade:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.DropDownListFor(x => x.Item4.ancienGradeId, ViewBag.Grades as SelectList, "---- Sélectionnez ----", new { @class = "form-control", id = "edit-CandidatAncienGradeId", disabled = "disabled" })
                            @Html.ValidationMessageFor(x => x.Item4.GradeId, null, new { style = "color: red" })
                        </div>
                        <div class="col-md-3">
                            <label for="dateRecrutement">Nouveau Grade:</label>
                        </div>
                        <div class="col-md-3">
                            @Html.DropDownListFor(x => x.Item4.nouveauGradeId, ViewBag.Grades as SelectList, "---- Sélectionnez ----", new { @class = "form-control", id = "edit-CandidatNouveauGradeId", disabled = "disabled" })
                            @Html.ValidationMessageFor(x => x.Item4.GradeId, null, new { style = "color: red" })
                        </div>
                    </div>
                    <div class="modal-footer">
                        <input type="submit" value="Actualiser" class="btn btn-custom btn-lg" />
                        <button type="button" class="btn btn-custom" data-dismiss="modal">Fermer</button>
                    </div>
                </form>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<!-- ************* RechercheAvancer ***************************** -->
<div id="Recherche" class="modal fade">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Recherche Avancée</h4>
            </div>
            <div class="modal-body">
                <form name="form-recherche-avancee" id="form-recherche-avancee" action="" method="post" class="form-horizontal">
                    <div class="form-group">
                        <div class="col-md-3">
                            <label for="Commission">Décision CAP :</label>
                        </div>
                        <div class="col-md-3">
                            <select class="form-control" name="Commission" id="Commission">
                                <option value="0">---- S&eacute;lectionnez ----</option>
                                <option value="1">Promu </option>
                                <option value="2">Non promu </option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="Direction">Direction:</label>
                        </div>
                        <div class="col-md-3">
                            <select class="form-control" name="Direction" id="Direction">
                                <option value="0">---- S&eacute;lectionnez ----</option>
                                <option value="1">Direction 1</option>
                                <option value="2">Direction 2</option>
                                <option value="3">Direction 3</option>
                                <option value="4">Direction 4</option>
                                <option value="5">Direction 5</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label for="Commission">Commission:</label>
                        </div>
                        <div class="col-md-3">
                            <select class="form-control" name="Commission" id="Commission">
                                <option value="0">---- S&eacute;lectionnez ----</option>
                                <option value="1">Commission 1</option>
                                <option value="2">Commission 2</option>
                                <option value="3">Commission 3</option>
                                <option value="4">Commission 4</option>
                                <option value="5">Commission 5</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="Commission">Statut:</label>
                        </div>
                        <div class="col-md-3">
                            <select class="form-control" name="Commission" id="Commission">
                                <option value="0">---- S&eacute;lectionnez ----</option>
                                <option value="1">En cours</option>
                                <option value="2">Vérifié</option>
                                <option value="3">Validé</option>

                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3">
                            <label for="Commission">Etat de sanction:</label>
                        </div>
                        <div class="col-md-3">
                            <input name="case" type="checkbox" />
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-custom" data-dismiss="modal">
                    <i class="fa fa-search"></i>
                    Rechercher
                </button>
                <button type="button" class="btn btn-custom" data-dismiss="modal">Fermer</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<script>
    $("#chkSelectAll").bind("change", function () {
        $(".chkSelect").prop("checked", $(this).prop("checked"));
     });
    $(".chkSelect").bind("change", function () {
        if (!$(this).prop("checked"))
            $("#chkSelectAll").prop("checked", false);
    });
    $(".alert").hide().fadeIn("slow");

    $("#promuId").click("click", function () {
        $('#motifDecisonId').hide();
    });

    $("#nonPromuId").click("click", function () {
        $('#motifDecisonId').show();
    });
    
</script>

<script type="text/javascript">
    $(document).ready(function () {
        jQuery.validator.methods.date = function (value, element) {
            var isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
            if (isChrome) {
                var d = new Date();
                return this.optional(element) || !/Invalid|NaN/.test(new Date(d.toLocaleDateString(value)));
            } else {
                return this.optional(element) || !/Invalid|NaN/.test(new Date(value));
            }
        };
    });
</script>


